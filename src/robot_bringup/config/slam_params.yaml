slam_toolbox:
  ros__parameters:
    # --- Frame Configuration ---
    odom_frame: odom
    map_frame: map
    # CRITICAL CHANGE: Updated from base_footprint to base_link
    base_frame: base_link 
    scan_topic: /scan
    mode: mapping
    
    # --- Timing and Synchronization ---
    use_sim_time: False
    transform_publish_period: 0.05  
    map_update_interval: 1.0        
    
    # --- TF Timeout & Stability ---
    transform_timeout: 0.5          
    tf_buffer_duration: 30.0
    
    # --- Lidar and Map Properties ---
    resolution: 0.05                
    max_laser_range: 12.0           
    minimum_time_interval: 0.1
    throttle_scans: 1               
    
    # --- Motion Sensitivity ---
    minimum_travel_distance: 0.1    
    minimum_travel_heading: 0.1     
    
    # --- Advanced Scan Matching ---
    use_scan_matching: true
    scan_buffer_size: 20            
    stack_size_to_use: 40000000     
    
    # --- Scan Matcher Parameters ---
    correlation_search_space_dimension: 0.5
    correlation_search_space_resolution: 0.01
    correlation_search_space_smear_deviation: 0.1
    
    # --- Loop Closure (Corrects drift) ---
    loop_search_maximum_distance: 5.0
    loop_search_space_dimension: 10.0
    distance_variance_penalty: 0.5
    angle_variance_penalty: 1.0